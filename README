This a set of tools and Python modules for prepare the input files for docking package(eg: Glide、AutoDock、Sybyl) and simulation package(eg: CHARMM、Amber) with the update charge(using EPB method).
The default output fileformat is mol2.
The origin charge of protein's atom by openmm and ligand atom origin charge from pybel 

Dependencies:
-------------

    To install it, make sure you have Python 2.7 or greater installed.
    Requires conda [1], openmm [2], pdbfixer [3], openbabel [4], requests [5] and pybel [6] to be installed on system.
    If your system missing [2],[3],[4],[5],[6] python modules, you can install this using three ways: conda install, 
    pip install or get source to install. And if you want to install it with conda, follow these steps on Linux/Ubuntu:

    1、install conda
       according to your system version, you can get the source as a sh-file from https://conda.io/miniconda.html
       (Example: your system is ubuntu/Linux with 64-bit, and download file name is Miniconda2-latest-Linux-x86_64.sh)
       after download: chmod +x  Miniconda2-latest-Linux-x86_64.sh
                       ./Miniconda2-latest-Linux-x86_64.sh
       (Attention: During setup, you'd better to choose yes option.)

    2、install openmm(default version: 7.1.1)
       conda install -c omnia openmm
       conda install -c omnia/label/beta openmm
       conda install -c omnia/label/dev openmm

    3、install pdbfixer(default version: 1.4)
       conda install -c omnia pdbfixer

    4、install openbabel(default version: 2.4.1)
       conda install -c openbabel openbabel 

    5、install requests(version: 2.18.4)
       conda install -c anaconda requests

    6、pip install pybel


Package describe
----------------

    After you decompression this package and access it:
    method I: if the destination is /home/lidong/test
              cp -r bin /home/lidong/test
              cp EPBLigCharge.py /home/lidong/test

              use "python EPBLigCharge.py -h" for help
    
    method II: cd package
                   chmod +x INSTALL.py
                   ./INSTALL.py
                   source ~/.bashrc

                use "python EPBLigCharge.py -h" for help



Testing
-------
    Please run the test(test pdbid: 1g5s) after you decompression this package and access it::
        EPB-CHARGE             --------------  it will prompt you how to use this code
        EPB-CHARGE -p 1g5s     --------------  it will download pdb(id:1g5s) from RCSB PDB, and saved as 1g5s.dpb
                                               (Attention: make sure your machine is connect to network if you want download)
    After run it, three new file with exists in this contents:
        1g5s.pdb               --------------  which you download from RCSB PDB(http://www.rcsb.org/pdb/home/home.do)
        LigWithNewCharges.mol2 --------------  the new ligand mol2 file and the charge is update



Example
-------

   1、If you have a PDBID(eg: 1g5s, if no file -- 1a28.pdb -- in current directory, it will download it from RCSB PDB database)
      
      * If use the default options, it will only update the ligand polar atom charges, and the default output is LigWithNewCharges.mol2 
        
                                    EPB-CHARGE -p 1g5s
        
     * If you want to change the output file format, you can add -f options.
        * if you add the option -f pdb, eg:
        
                                    EPB-CHARGE -p 1g5s -f pdb
        
          the ouput file is: LigWithNewCharges.pdb 
        * if you add the option -f None (that is to say contain pdb and mol2), eg:
        
                                    EPB-CHARGE -p 1g5s -f None
        
          the ouput file is: LigWithNewCharges.mol2, LigWithNewCharges.pdb 
     
     
     * If you want to change the output filename, you can add -o options

                                    EPB-CHARGE -p 1g5s -o 1g5s_new
       
       The output file is: 1g5s_new.mol2 
       
       
     * If you want to reserve the Intermediate file in order to understand the process, you can add -t 1 option, eg:
   
                                    EPB-CHARGE -p 1g5s -t 1

         The output: LigWithNewCharges.mol2, tmp_file 
         The Intermediate file will saved as tmp_file, the file name and inforamtion write in tmp_file.dat 
   
   		  
   2、If you have a pdb file(eg: example1.pdb) and not contain ligand、confactor、ion or water
      (default output filename: update_receptor), eg：
   
                                   EPB-CHARGE -p example1.pdb
   
   3、If you have two file ----- one is protein file(format: pdb), and other is ligand file(format: pdb/mol2)
                                 both of them is the protein file(format: pdb)
   
      * if protein file name is 1g5s_receptor.pdb and ligand file name is 1g5s_ligand.pdb(or 1g5s_ligand.mol2), eg:
      
                                   EPB-CHARGE -p 1g5s_receptor.pdb -l 1g5s_ligand.pdb
                          
                          or       
                          
                                   EPB-CHARGE -p 1g5s_receptor.pdb -l 1g5s_ligand.mol2
      

   *** For example 2 and example 3, the other option usage, you can get it from example 1.
       You can give the options in any position, but make sure the option key close to the option.
